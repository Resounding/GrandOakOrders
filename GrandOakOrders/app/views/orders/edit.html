<template>
    <require from="../../controls/currencyTextbox"></require>
    <require from="./orderItem"></require>

    <div class="container">
        <div class="fixed-tool-bar">
            <button type="button" class="btn dropdown-button left" data-activates="reportsDropdown">
                <i class="material-icons">printer</i>
                Reports
            </button>
            <ul id="reportsDropdown" class="dropdown-content">
                <li>
                    <a id="kitchenReport" href="/Reports/KitchenOrder/${_model.Id}?format=pdf" target="_blank">
                        Kitchen Order (pdf)
                    </a>
                </li>
                <li>
                    <a id="kitchenReport" href="/Reports/KitchenOrder/${_model.Id}?format=rtf" target="_blank">
                        Kitchen Order (Word)
                    </a>
                </li>
            </ul>
            <a class="btn waves-effect waves-light white blue-text" href="#/orders">Cancel</a>
            <a class="btn waves-effect waves-light blue" click.trigger="save($event)">Save</a>
        </div>
        <div class="row">
            <div class="col s12">
                
            </div>
        </div>
        <div class="row">
            <form class="col s12">
                <div class="row">
                    <div class="input-field col s12">
                        <h4>Order #${_model.Id}</h4>
                    </div>
                </div>
                <ul class="collapsible popout" data-collapsible="expandable">
                    <li>
                        <div class="collapsible-header ${_model.DateAndTime ? 'double-header' : ''}">
                            <div class="duplicate">${_model.HeaderText}</div>
                            <div class="duplicate" show.bind="_model.DateAndTime">${_model.DateAndTime}</div>
                        </div>
                        <div class="collapsible-body">
                            <div class="row">
                                <div class="input-field col s6">
                                    <input id="organization" type="text" value.bind="_model.Inquiry.Organization">
                                    <label for="organization" class="active">Organization:</label>
                                </div>
                                <div class="input-field col s6">
                                    <input id="caller" type="text" value.bind="_model.Inquiry.ContactPerson">
                                    <label for="caller" class="active">Person Calling:</label>
                                </div>
                                <div class="input-field col s6">
                                    <input id="phone" type="tel" value.bind="_model.Inquiry.Phone">
                                    <label for="phone" class="active">Phone Number:</label>
                                </div>
                                <div class="input-field col s6">
                                    <input id="email" type="email" value.bind="_model.Inquiry.Email">
                                    <label for="email" class="active">Email:</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s6">
                                    <input id="date" type="text" class="datepicker" value.bind="_model.Inquiry.EventDate">
                                    <label for="date" class="active">Event Date:</label>
                                </div>
                                <div class="input-field col s6">
                                    <input id="time" type="text" class="timepicker" value.bind="_model.Inquiry.EventTime">
                                    <label for="time" class="active">Event Time:</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s2">
                                    <input id="people" type="number" min="0" value.bind="_model.Inquiry.People">
                                    <label for="people" class="active"># People:</label>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="collapsible-header">
                            <span class="duplicate">${_model.Inquiry.Summary}</span>
                        </div>
                        <div class="collapsible-body">
                            <div class="row">
                                <div class="input-field col s10">
                                    <textarea id="summary" class="materialize-textarea" value.bind="_model.Inquiry.Summary"></textarea>
                                    <label for="summary" class="active">Summary:</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <textarea id="description" class="materialize-textarea" value.bind="_model.Inquiry.Description"></textarea>
                                    <label for="caller" class="active">Fine Details:</label>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="collapsible-header ${_model.Inquiry.Location && _model.Inquiry.LocationAddress ? 'double-header' : ''}">
                            <div>
                                ${ _model.Inquiry.DeliveryType }
                                <span class="duplicate" show.bind="_model.Inquiry.Location">${_model.Inquiry.Location}</span>
                            </div>
                            <div class="duplicate" show.bind="_model.Inquiry.LocationAddress">${_model.Inquiry.LocationAddress}</div>
                        </div>
                        <div class="collapsible-body">
                            <div class="row">
                                <div class="input-field col s12">
                                    <select id="deliveryType" class="browser-default" value.bind="_model.Inquiry.DeliveryType">
                                        <option value="Delivered">Delivery</option>
                                        <option value="Pickup">Pickup</option>
                                        <option value="In-House">In-House</option>
                                        <option value="Off-Site">Off-Site</option>
                                    </select>
                                    <label for="deliveryType" class="active">Pickup / Delivery:</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s6">
                                    <input id="location" type="text" value.bind="_model.Inquiry.Location">
                                    <label for="location" class="active">Location:</label>
                                </div>
                                <div class="input-field col s6">
                                    <input id="address" type="text" value.bind="_model.Inquiry.LocationAddress">
                                    <label for="address" class="active">Address:</label>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
                <div class="divider"></div>
                <div class="section">
                    <h5>Order Details</h5>
                    <order-item repeat.for="item of sortedItems" item.bind="item"></order-item>
                    <div class="row">
                        <button type="button" class="btn right green" click.trigger="addItem()">
                            <i class="material-icons">add</i>
                        </button>
                    </div>
                    <div class="divider"></div>
                    <div class="row">
                        <h5 class="col s9">Sub-Total</h5>
                        <h5 class="col s3" style="text-align: right;" innerHTML.bind="'$' + (_model.SubTotal || 0).toFixed(2)"></h5>
                    </div>
                    <div class="row">
                        <h5 class="col s9">${_model.TaxCode} (${_model.TaxRate * 100}%)</h5>
                        <h5 class="col s3" style="text-align: right;" innerHTML.bind="'$' + (_model.TotalTax || 0).toFixed(2)"></h5>
                    </div>
                    <div class="row">
                        <h5 class="col s9">Gratuity</h5>
                        <div class="col s3">
                            <input id="gratuity" type="text" class="text-right h5" value.bind="_model.Gratuity" currency>
                        </div>
                    </div>
                    <div class="row">
                        <h5 class="col s9">Less Deposit</h5>
                        <div class="col s3">
                            <input id="deposit" type="text" class="text-right h5" value.bind="_model.Deposit" currency="negative">
                        </div>
                    </div>
                    <div class="divider"></div>
                    <div class="row">
                        <h5 class="col s9">Total</h5>
                        <h5 class="col s3" style="text-align: right;" innerHTML.bind="'$' + (_model.GrandTotal || 0).toFixed(2)"></h5>
                    </div>
                </div>
                <div class="divider"></div>
                <ul class="collapsible popout" data-collapsible="expandable">
                    <li>
                        <div class="collapsible-header">
                            <div>
                                <strong>Notes &amp; Comments:</strong>
                                <span class="duplicate">${_model.Notes}</span>
                            </div>
                        </div>
                        <div class="collapsible-body">
                            <div class="row">
                                <div class="input-field col s12">
                                    <textarea id="notes" class="materialize-textarea" value.bind="_model.Notes"></textarea>
                                    <label for="notes" class="active">Notes</label>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="collapsible-header">
                            <strong>Pickup Notes:</strong>
                            <span class="duplicate">${_model.PickupNotes}</span>
                        </div>
                        <div class="collapsible-body">
                            <div class="row">
                                <div class="input-field col s12">
                                    <textarea id="pickupNotes" class="materialize-textarea" value.bind="_model.PickupNotes"></textarea>
                                    <label for="pickupNotes" class="active">Pickup Notes:</label>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="collapsible-header">
                            <strong>Allergy Notes:</strong>
                            <span class="duplicate">${_model.AllergyNotes}</span>
                        </div>
                        <div class="collapsible-body">
                            <div class="row">
                                <div class="input-field col s12">
                                    <textarea id="allergyNotes" class="materialize-textarea" value.bind="_model.AllergyNotes"></textarea>
                                    <label for="allergyNotes" class="active">Allergy Notes:</label>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </form>
        </div>
    </div>
</template>